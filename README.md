# illustrator-scripts 

## 如何使用illustrator scripts：
1. 下载脚本，保存到任意位置；
2. 在 illustrator 中，选择 File -> Scripts -> Browse... ，然后选中对应脚本；
3. 点击回车，运行脚本。


## excelContentFiller
将 excel 内容，填充到 .ai 文件中，需要在 excel 的标题行或标题列中，填写与.ai文件中图形组/图形项名称中，相对应的变量名称。支持以行或者列为单位。

当前支持功能有： 

### 填充功能

#### 文本写入 
- ##### 直接写入 fillText()
    ```item {_ propName}``` 
    从 excel 的标题行/列中，找到 propName 的内容进行填充。
  
- ##### 模板写入 fillTextInTemplet()
    ```item "{_ year}年{_ month}月{_ date}日"```
    文本会类似于js的模板语法，其中_和空格表示这是文本，后面的是变量名称。
  
- ##### 文本框内写入 fillTxtInFrame()
    ```item {_(inFrame) propName}```
    文本会尽可能填满文本框，需要在文本框下留空，可以在 excel 单元格内换行，每行用特殊字符填充，最后使用 ```tool - regReplace.jsx``` 进行替换。
  
- ##### 强制行数 fillAndKeepLinesForTxtAvatar()
    ```item {_(forceLines) propName}```
    文本会自动进行尺寸缩放，让文本在文本框中的行数，与输入一致；需要将行距设置为 1，将段后间距用作行距。

其中 propName 为属性名，item 为图形项原本名称，可保留可不保留；

与之对应 Excel 示范为： 
| 变量名 | 填充到第一个画板的内容 | 填充到第二个画板的内容 |
|------------|-------------|---------------|
| **text1** | 滚滚长江东逝水     | 白发渔樵江渚上       |
| **text2**  | 浪花淘尽英雄      | 惯看秋月春风        |
| **text3**  | 是非成败转头空     | 一壶浊酒喜相逢       |
| **text4**  | 青山依旧在       | 古今多少事         |
| **text5**  | 几度夕阳红       | 都付笑谈中         |
| **text6**  | 青山依旧在<br>几度夕阳红       | 古今多少事<br>都付笑谈中         |

图层名为
```
文本 1 {_ text1}
聚合文本 `{_ text1},{_text2},{_text3},{_text4},{_text5}`
文本框 {_(inFrame) text3}
文本框并且模板填充 {_(inFrame) `{_text4},{_text5}`}
强制行数文本 {_(forceLines) text6}
```

#### 图片替换
```{~ propName}```
从 excel 的标题行/列中，找到 propName 的图片文件名，在ai文件所在文件夹查找对应文件，根据原来图片尺寸进行覆盖填充；如果原来图片没有剪切蒙版，将新建与原来图片大小相同的剪切蒙版。
如果填入内容不包含后缀名，则尝试查找常用图片后缀名文件，如 .png .jpg .jpeg .gif .bmp …… 

| 变量名 | 填充到第一个画板的内容 | 填充到第二个画板的内容 |
|------------|-------------|---------------|
| **img1** | example     | myPhoto.jpg       |

图层名为
```
图片1 {~ img1}
```

### 版式功能
版式功能暂不支持变量指定，无需在 Excel 中填写。

#### 对齐/目标对齐
##### 对齐
```{<=<}``` ```{>=>}``` ```{^=^}``` ```{v=v}```
目前支持左右上下对齐，修改编组名称包含上述内容之一即可使用⬆️；
对齐功能以左对齐为例子，效果为左对象的左，与右对象的左，距离为 0 。
##### 目标对齐
需要使用目标对齐时，在编组内其中一个对象名称包含```{=}```即可。 

#### 排列
```{<<}``` ```{>>}``` ```{^^}``` ```{vv}```
目前支持左右上下排列，修改编组名称包含上述内容之一即可使用⬆️；
排列功能以左排列为例子，效果为左对象的左，到右对象的左，与右对象的左，到右二对象的左，相同，后续对象如此类推；

#### 间距
```{<}``` ```{>}``` ```{^}``` ```{v}```
目前支持左右上下间距，修改编组名称包含上述内容之一即可使用⬆️；
间距功能以左间距为例子，效果为左对象的右，到右对象的左，与右对象的右，到右二对象的左，相同，后续对象如此类推；

<small>//TODO 补充说明图片、补充居中对齐、补充对对象名称赋值的脚本 
</small>

## tool - regReplace.jsx
简易的文本查找替换。 运行时，如果正在选中文本对象，则修改为当前选中文本对象；如果没有选中，则询问是否对所有文本对象进行操作；
运行时，会弹出一个 dialog，可以选择是否使用正则；第一个文本框可填入普通文本或者正则表达式；启用正则表达式后，第二个文本框可以使用 $1 这种分组结果；如果不使用正则，第二个文本框直接填入普通文本即可。

## tool - finalExport.jsx
简单的保存并转曲另存pdf的脚本。脚本会先另存一份 source.ai 文件，然后遍历所有图层和对象，将锁定的解锁，将隐藏的删除，将所有外链嵌入，然后全选、扩展、全选、扩展外观，最后保存为 Acrobat4.0 兼容的 pdf 文件。

## 鸣谢
感谢优设各位小伙伴的帮助